<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Worker Fatigue Classifier | Alberto Mussali</title> <meta name="author" content="Alberto Mussali"> <meta name="description" content="Predicting Fatigue Levels Using Brainwave Data and Machine Learning"> <meta name="keywords" content="portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://albertomussali.github.io/projects/EEG/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body class="fixed-top-nav"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Alberto </span>Mussali</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-article> <h1 id="predicting-fatigue-levels-using-brainwave-data-and-machine-learning">Predicting Fatigue Levels Using Brainwave Data and Machine Learning</h1> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/Proj_EEG/brain-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/Proj_EEG/brain-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/Proj_EEG/brain-1400.webp"></source> <img src="/assets/img/Proj_EEG/brain.jpeg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>In the realm of cutting-edge technology, the potential of machine learning is gradually seeping into various real-world applications. Among the myriad possibilities, one particularly intriguing avenue is its role in safeguarding the well-being of workers by monitoring their fatigue levels. This unique project harnesses the power of machine learning, brainwave data, and sophisticated devices to accurately predict an individual’s fatigue state. In this article, we delve into the intricate details of this project, exploring its motivation, methodologies, and potential industry applications.</p> <h2 id="abstract">Abstract</h2> <p>Machine learning, although still in its early stages of practical adoption, demonstrates a promising potential in real-life scenarios. One such scenario revolves around ensuring worker safety and productivity by gauging their levels of fatigue during their tasks. Leveraging the capabilities of wearable electroencephalograms (EEGs), this project involved recording EEG data from both fatigued (with less than 4 hours of sleep) and non-fatigued individuals. The collected data underwent a series of preprocessing steps, feature generation techniques, and Principal Component Analysis (PCA), culminating in the creation of images representing each state. Utilizing these resources, Artificial Neural Networks and Convolutional Neural Networks were trained to predict fatigue levels with remarkable accuracy, showcasing the potential of this innovative approach.</p> <h2 id="introduction">Introduction</h2> <h3 id="motivation">Motivation</h3> <p>At the heart of this endeavor lies an intrinsic curiosity about the mechanics of Artificial and Convolutional Neural Networks (ANNs, CNNs) and the complexities they mirror from our own neural networks. This project emerges as an avenue to comprehend the intricate workings of the human mind while utilizing brainwave data for applications in artificial intelligence. By collecting and analyzing brainwave data, a unique opportunity is unveiled to bridge the gap between neural phenomena and advanced machine learning techniques.</p> <h3 id="project-goal">Project Goal</h3> <p>The central objective of this study was to harness the capabilities of machine learning models to predict an individual’s fatigue state based solely on their brainwave data. Fatigue was defined as having less than 4 hours of sleep in the past 24 hours, while a non-fatigued individual had received at least 6 hours of sleep and felt well-rested. The Muse 2 device, originally designed as a meditation aid, was repurposed alongside the MindMonitor app to capture raw brainwave patterns and variations associated with sleep deprivation and well-rested states. By applying machine learning algorithms to this data, the models were able to accurately classify an individual’s level of sleep deprivation.</p> <h2 id="industry-applications">Industry Applications</h2> <h3 id="enhancing-workplace-safety">Enhancing Workplace Safety</h3> <p>The implications of this research extend into real-world scenarios, particularly within the manufacturing industry. In factory settings, where workers operate heavy machinery demanding full attention, the deployment of machine learning models could ensure that employees do not work while fatigued. Notably, sleep-induced fatigue contributes to a significant portion of workplace injuries and financial losses. By preventing fatigued workers from operating machinery, the manufacturing sector could potentially save millions of dollars annually.</p> <h3 id="averting-drowsy-driving-accidents">Averting Drowsy Driving Accidents</h3> <p>The significance of identifying fatigue transcends industrial domains. Consider the realm of road safety, where drowsy driving is a pressing concern. By enabling law enforcement to detect the likelihood of a driver falling asleep, the staggering number of accidents caused by drowsy driving could be significantly reduced. This approach has the potential to save lives and mitigate the economic burden associated with such accidents.</p> <h3 id="elevating-critical-professions">Elevating Critical Professions</h3> <p>Industries relying on precision and critical decision-making, such as healthcare and construction, also stand to benefit from fatigue prediction. Nurses, doctors, and construction workers, tasked with safeguarding public safety, often work long hours and night shifts, making them susceptible to fatigue-related errors. Identifying fatigue levels in such professionals could enhance their performance and ensure optimal decision-making.</p> <h2 id="background-and-overview">Background and Overview</h2> <h3 id="neural-oscillations-unveiled">Neural Oscillations Unveiled</h3> <p>Neural oscillations, characterized by repetitive patterns of neural activity in the Central Nervous System, serve as the foundation for this study. EEG bands, associated with specific behaviors and pathologies, are key indicators of brainwave patterns. These bands offer insights into various states of consciousness, laying the groundwork for the subsequent analysis.</p> <h3 id="data-collection">Data Collection</h3> <p>The Muse 2 device, renowned as a meditation aid, proves to be an unlikely protagonist in fatigue prediction. Outfitted with electrodes and sensors, it captures real-time brainwave activity, which when coupled with the MindMonitor app, facilitates data collection and analysis. The captured data reveals the nuances of brain activity during sleep deprivation and well-rested states, setting the stage for subsequent ML-based analyses.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/Proj_EEG/EEG_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/Proj_EEG/EEG_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/Proj_EEG/EEG_1-1400.webp"></source> <img src="/assets/img/Proj_EEG/EEG_1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Muse 2" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption">Muse 2 device and associated EEG sensor locations.</div> <h2 id="data-preprocessing-and-feature-generation">Data Preprocessing and Feature Generation</h2> <h3 id="unraveling-complex-data">Unraveling Complex Data</h3> <p>Data preprocessing forms a critical bridge between raw data and machine learning models. The process involves refining the EEG readings, cleaning sensor data, and converting time formats for compatibility. The focus shifts to feature generation through Bird’s <d-cite key="bird2018study"></d-cite> <d-cite key="bird2019mental"></d-cite> <d-cite key="bird2019deep"></d-cite> <d-cite key="ashford2019classification"></d-cite> [see note below] open-source Python method. This method transforms raw EEG readings into a rich set of 989 features through sliding window methods, each contributing to the intricate puzzle of fatigue prediction.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/Proj_EEG/Pipe-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/Proj_EEG/Pipe-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/Proj_EEG/Pipe-1400.webp"></source> <img src="/assets/img/Proj_EEG/Pipe.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Data Pipe" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/Proj_EEG/Ex_Images-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/Proj_EEG/Ex_Images-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/Proj_EEG/Ex_Images-1400.webp"></source> <img src="/assets/img/Proj_EEG/Ex_Images.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Sample Images" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption">Top: Overview of data pipeline. Bottom: Sample generated images from PCA components (upsampled for ease of visualization).</div> <details><summary>Details: Bird’s EEG Feature Generation Code</summary> <p>The present work heavily relies on Jordan J. Bird et. al.’s work in 2018, and 2019. The relevant code referenced in this section, as well as the relevant papers where it is used in the literature, is <a href="https://github.com/jordan-bird/eeg-feature-generation" rel="external nofollow noopener" target="_blank">available here.</a> The code was modified slightly in the present work.</p> </details> <h2 id="principal-component-analysis-and-image-generation">Principal Component Analysis and Image Generation</h2> <h3 id="transforming-data-dimensions">Transforming Data Dimensions</h3> <p>Principal Component Analysis (PCA) emerges as a powerful technique to reduce feature dimensions while preserving data essence. By condensing 989 features to 225 principal components, the dataset becomes more manageable and conducive to machine learning. Moreover, these components serve as the foundation for generating square (\(15^2 = 225\)) grayscale images, unlocking the convolutional power of neural networks.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/Proj_EEG/PCA-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/Proj_EEG/PCA-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/Proj_EEG/PCA-1400.webp"></source> <img src="/assets/img/Proj_EEG/PCA.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="PCA Image Generation" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption">PCA Image generation.</div> <h2 id="machine-learning-models">Machine Learning Models</h2> <h3 id="unveiling-predictive-potential">Unveiling Predictive Potential</h3> <p>Several machine learning models take center stage in this study. Artificial Neural Networks (ANNs), Convolutional Neural Networks (CNNs), Random Forest, and Logistic Regression step into the spotlight to unravel the complexity of fatigue prediction. Each model showcases its unique strengths and limitations, with varying levels of accuracy and susceptibility to overfitting.</p> <div class="row justify-content-sm-center align-items-center"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/Proj_EEG/CNN_arch_t-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/Proj_EEG/CNN_arch_t-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/Proj_EEG/CNN_arch_t-1400.webp"></source> <img src="/assets/img/Proj_EEG/CNN_arch_t.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="CNN Architecture" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/Proj_EEG/CNN_gr-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/Proj_EEG/CNN_gr-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/Proj_EEG/CNN_gr-1400.webp"></source> <img src="/assets/img/Proj_EEG/CNN_gr.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="CNN Architecture" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption">The architecture for one of our CNN models.</div> <h2 id="results-and-limitations">Results and Limitations</h2> <h3 id="navigating-through-the-findings">Navigating Through the Findings</h3> <p>The study’s evaluation through 3-Fold Cross Validation paints a picture of near-perfect accuracy across the models. However, this commendable performance is tempered by the specter of overfitting, stemming from the limited dataset size. The lack of variability and randomness in data collection limits the generalizability of results. While the models excel in distinguishing fatigue states within this constrained context, their true potential emerges in a larger, more diverse dataset.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/Proj_EEG/Res-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/Proj_EEG/Res-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/Proj_EEG/Res-1400.webp"></source> <img src="/assets/img/Proj_EEG/Res.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="PCA Image Generation" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption">Cross-Validation (K=3) results for several tested ML algorithms. CNN uses image dataset, others use the same data in a flattened vector format.</div> <h2 id="conclusion-and-future-implications">Conclusion and Future Implications</h2> <h3 id="pioneering-a-path-forward">Pioneering a Path Forward</h3> <p>In the realm of brainwave data and machine learning, this project has illuminated a path toward predicting fatigue levels with impressive accuracy. The Muse 2 device, once confined to meditation practices, emerges as a potent tool for unraveling the intricacies of our neural activity. While the study’s outcomes are promising, the potential lies in future iterations with expanded datasets, encompassing various forms of fatigue and more robust data collection. As technology advances and machine learning further integrates into our lives, the boundaries of possibility continue to expand, forging a future where fatigue prediction is a cornerstone of well-being and safety.</p> <h2 id="acknowledgements">Acknowledgements</h2> <p>This article presents work developed by the following authors:</p> <ol> <li>Alberto Mussali</li> <li><a href="https://musa-habib.com/" rel="external nofollow noopener" target="_blank">Musa Habib</a></li> <li><a href="https://anantgoyal.com/" rel="external nofollow noopener" target="_blank">Anant Goyal</a></li> <li><a href="https://linkedin.com/in/sadul-bombuwala-6a556819b" rel="external nofollow noopener" target="_blank">Sadul Bombuwala</a></li> </ol> <p>A big thank-you is more than due to our professor and supervisor for this project: <a href="https://mech.ubc.ca/ahmad-mohammadpanah/" rel="external nofollow noopener" target="_blank">Ahmad Mohammadpanah.</a></p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/Proj_EEG.bib"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Alberto Mussali. Last updated: August 28, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>